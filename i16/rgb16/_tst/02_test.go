// Copyright 2012 The Chroma Authors. All rights reserved. See the LICENSE file.

package rgb16

import (
	"fmt"
	"math"
	"testing"
)

func check_diff(x, y uint16) bool {
	const acc uint16 = 2000 // accuracy
	var d uint16
	if x >= y {
		d = x - y
	} else {
		d = y - x
	}
	if d > acc {
		return false
	}
	return true
}

// Test that a subset of RGB space can be converted to XYZ and back to within tolerance. 
func TestRgb2RgbRoundtrip(t *testing.T) {
	var (
		i, j, k, l, step	int
		r, g, b              uint16
		rw, gw, bw, r1w, g1w, b1w uint16
	)
	type fn1 func(r, g, b uint16) (r, g, b uint16)
	type fn2 func(r, g, b uint16) (r, g, b uint16)
	f1 := []fn1{Adobe_D50ToAdobe, Adobe_D50ToApple, Adobe_D50ToApple_D50, Adobe_D50ToBest, Adobe_D50ToBeta, Adobe_D50ToBruce, Adobe_D50ToBruce_D50, Adobe_D50ToCIE, Adobe_D50ToCIE_D50, Adobe_D50ToColorMatch, Adobe_D50ToDon, Adobe_D50ToECI, Adobe_D50ToEktaSpace, Adobe_D50ToNTSC, Adobe_D50ToNTSC_D50, Adobe_D50ToPAL, Adobe_D50ToPAL_D50, Adobe_D50ToProPhoto, Adobe_D50ToSMPTE_C, Adobe_D50ToSMPTE_C_D50, Adobe_D50ToSRGB, Adobe_D50ToSRGB_D50, Adobe_D50ToWGamut, AdobeToAdobe_D50, AdobeToApple, AdobeToApple_D50, AdobeToBest, AdobeToBeta, AdobeToBruce, AdobeToBruce_D50, AdobeToCIE, AdobeToCIE_D50, AdobeToColorMatch, AdobeToDon, AdobeToECI, AdobeToEktaSpace, AdobeToNTSC, AdobeToNTSC_D50, AdobeToPAL, AdobeToPAL_D50, AdobeToProPhoto, AdobeToSMPTE_C, AdobeToSMPTE_C_D50, AdobeToSRGB, AdobeToSRGB_D50, AdobeToWGamut, Apple_D50ToAdobe, Apple_D50ToAdobe_D50, Apple_D50ToApple, Apple_D50ToBest, Apple_D50ToBeta, Apple_D50ToBruce, Apple_D50ToBruce_D50, Apple_D50ToCIE, Apple_D50ToCIE_D50, Apple_D50ToColorMatch, Apple_D50ToDon, Apple_D50ToECI, Apple_D50ToEktaSpace, Apple_D50ToNTSC, Apple_D50ToNTSC_D50, Apple_D50ToPAL, Apple_D50ToPAL_D50, Apple_D50ToProPhoto, Apple_D50ToSMPTE_C, Apple_D50ToSMPTE_C_D50, Apple_D50ToSRGB, Apple_D50ToSRGB_D50, Apple_D50ToWGamut, AppleToAdobe, AppleToAdobe_D50, AppleToApple_D50, AppleToBest, AppleToBeta, AppleToBruce, AppleToBruce_D50, AppleToCIE, AppleToCIE_D50, AppleToColorMatch, AppleToDon, AppleToECI, AppleToEktaSpace, AppleToNTSC, AppleToNTSC_D50, AppleToPAL, AppleToPAL_D50, AppleToProPhoto, AppleToSMPTE_C, AppleToSMPTE_C_D50, AppleToSRGB, AppleToSRGB_D50, AppleToWGamut, BestToAdobe, BestToAdobe_D50, BestToApple, BestToApple_D50, BestToBeta, BestToBruce, BestToBruce_D50, BestToCIE, BestToCIE_D50, BestToColorMatch, BestToDon, BestToECI, BestToEktaSpace, BestToNTSC, BestToNTSC_D50, BestToPAL, BestToPAL_D50, BestToProPhoto, BestToSMPTE_C, BestToSMPTE_C_D50, BestToSRGB, BestToSRGB_D50, BestToWGamut, BetaToAdobe, BetaToAdobe_D50, BetaToApple, BetaToApple_D50, BetaToBest, BetaToBruce, BetaToBruce_D50, BetaToCIE, BetaToCIE_D50, BetaToColorMatch, BetaToDon, BetaToECI, BetaToEktaSpace, BetaToNTSC, BetaToNTSC_D50, BetaToPAL, BetaToPAL_D50, BetaToProPhoto, BetaToSMPTE_C, BetaToSMPTE_C_D50, BetaToSRGB, BetaToSRGB_D50, BetaToWGamut, Bruce_D50ToAdobe, Bruce_D50ToAdobe_D50, Bruce_D50ToApple, Bruce_D50ToApple_D50, Bruce_D50ToBest, Bruce_D50ToBeta, Bruce_D50ToBruce, Bruce_D50ToCIE, Bruce_D50ToCIE_D50, Bruce_D50ToColorMatch, Bruce_D50ToDon, Bruce_D50ToECI, Bruce_D50ToEktaSpace, Bruce_D50ToNTSC, Bruce_D50ToNTSC_D50, Bruce_D50ToPAL, Bruce_D50ToPAL_D50, Bruce_D50ToProPhoto, Bruce_D50ToSMPTE_C, Bruce_D50ToSMPTE_C_D50, Bruce_D50ToSRGB, Bruce_D50ToSRGB_D50, Bruce_D50ToWGamut, BruceToAdobe, BruceToAdobe_D50, BruceToApple, BruceToApple_D50, BruceToBest, BruceToBeta, BruceToBruce_D50, BruceToCIE, BruceToCIE_D50, BruceToColorMatch, BruceToDon, BruceToECI, BruceToEktaSpace, BruceToNTSC, BruceToNTSC_D50, BruceToPAL, BruceToPAL_D50, BruceToProPhoto, BruceToSMPTE_C, BruceToSMPTE_C_D50, BruceToSRGB, BruceToSRGB_D50, BruceToWGamut, CIE_D50ToAdobe, CIE_D50ToAdobe_D50, CIE_D50ToApple, CIE_D50ToApple_D50, CIE_D50ToBest, CIE_D50ToBeta, CIE_D50ToBruce, CIE_D50ToBruce_D50, CIE_D50ToCIE, CIE_D50ToColorMatch, CIE_D50ToDon, CIE_D50ToECI, CIE_D50ToEktaSpace, CIE_D50ToNTSC, CIE_D50ToNTSC_D50, CIE_D50ToPAL, CIE_D50ToPAL_D50, CIE_D50ToProPhoto, CIE_D50ToSMPTE_C, CIE_D50ToSMPTE_C_D50, CIE_D50ToSRGB, CIE_D50ToSRGB_D50, CIE_D50ToWGamut, CIEToAdobe, CIEToAdobe_D50, CIEToApple, CIEToApple_D50, CIEToBest, CIEToBeta, CIEToBruce, CIEToBruce_D50, CIEToCIE_D50, CIEToColorMatch, CIEToDon, CIEToECI, CIEToEktaSpace, CIEToNTSC, CIEToNTSC_D50, CIEToPAL, CIEToPAL_D50, CIEToProPhoto, CIEToSMPTE_C, CIEToSMPTE_C_D50, CIEToSRGB, CIEToSRGB_D50, CIEToWGamut, ColorMatchToAdobe, ColorMatchToAdobe_D50, ColorMatchToApple, ColorMatchToApple_D50, ColorMatchToBest, ColorMatchToBeta, ColorMatchToBruce, ColorMatchToBruce_D50, ColorMatchToCIE, ColorMatchToCIE_D50, ColorMatchToDon, ColorMatchToECI, ColorMatchToEktaSpace, ColorMatchToNTSC, ColorMatchToNTSC_D50, ColorMatchToPAL, ColorMatchToPAL_D50, ColorMatchToProPhoto, ColorMatchToSMPTE_C, ColorMatchToSMPTE_C_D50, ColorMatchToSRGB, ColorMatchToSRGB_D50, ColorMatchToWGamut, DonToAdobe, DonToAdobe_D50, DonToApple, DonToApple_D50, DonToBest, DonToBeta, DonToBruce, DonToBruce_D50, DonToCIE, DonToCIE_D50, DonToColorMatch, DonToECI, DonToEktaSpace, DonToNTSC, DonToNTSC_D50, DonToPAL, DonToPAL_D50, DonToProPhoto, DonToSMPTE_C, DonToSMPTE_C_D50, DonToSRGB, DonToSRGB_D50, DonToWGamut, ECIToAdobe, ECIToAdobe_D50, ECIToApple, ECIToApple_D50, ECIToBest, ECIToBeta, ECIToBruce, ECIToBruce_D50, ECIToCIE, ECIToCIE_D50, ECIToColorMatch, ECIToDon, ECIToEktaSpace, ECIToNTSC, ECIToNTSC_D50, ECIToPAL, ECIToPAL_D50, ECIToProPhoto, ECIToSMPTE_C, ECIToSMPTE_C_D50, ECIToSRGB, ECIToSRGB_D50, ECIToWGamut, EktaSpaceToAdobe, EktaSpaceToAdobe_D50, EktaSpaceToApple, EktaSpaceToApple_D50, EktaSpaceToBest, EktaSpaceToBeta, EktaSpaceToBruce, EktaSpaceToBruce_D50, EktaSpaceToCIE, EktaSpaceToCIE_D50, EktaSpaceToColorMatch, EktaSpaceToDon, EktaSpaceToECI, EktaSpaceToNTSC, EktaSpaceToNTSC_D50, EktaSpaceToPAL, EktaSpaceToPAL_D50, EktaSpaceToProPhoto, EktaSpaceToSMPTE_C, EktaSpaceToSMPTE_C_D50, EktaSpaceToSRGB, EktaSpaceToSRGB_D50, EktaSpaceToWGamut, NTSC_D50ToAdobe, NTSC_D50ToAdobe_D50, NTSC_D50ToApple, NTSC_D50ToApple_D50, NTSC_D50ToBest, NTSC_D50ToBeta, NTSC_D50ToBruce, NTSC_D50ToBruce_D50, NTSC_D50ToCIE, NTSC_D50ToCIE_D50, NTSC_D50ToColorMatch, NTSC_D50ToDon, NTSC_D50ToECI, NTSC_D50ToEktaSpace, NTSC_D50ToNTSC, NTSC_D50ToPAL, NTSC_D50ToPAL_D50, NTSC_D50ToProPhoto, NTSC_D50ToSMPTE_C, NTSC_D50ToSMPTE_C_D50, NTSC_D50ToSRGB, NTSC_D50ToSRGB_D50, NTSC_D50ToWGamut, NTSCToAdobe, NTSCToAdobe_D50, NTSCToApple, NTSCToApple_D50, NTSCToBest, NTSCToBeta, NTSCToBruce, NTSCToBruce_D50, NTSCToCIE, NTSCToCIE_D50, NTSCToColorMatch, NTSCToDon, NTSCToECI, NTSCToEktaSpace, NTSCToNTSC_D50, NTSCToPAL, NTSCToPAL_D50, NTSCToProPhoto, NTSCToSMPTE_C, NTSCToSMPTE_C_D50, NTSCToSRGB, NTSCToSRGB_D50, NTSCToWGamut, PAL_D50ToAdobe, PAL_D50ToAdobe_D50, PAL_D50ToApple, PAL_D50ToApple_D50, PAL_D50ToBest, PAL_D50ToBeta, PAL_D50ToBruce, PAL_D50ToBruce_D50, PAL_D50ToCIE, PAL_D50ToCIE_D50, PAL_D50ToColorMatch, PAL_D50ToDon, PAL_D50ToECI, PAL_D50ToEktaSpace, PAL_D50ToNTSC, PAL_D50ToNTSC_D50, PAL_D50ToPAL, PAL_D50ToProPhoto, PAL_D50ToSMPTE_C, PAL_D50ToSMPTE_C_D50, PAL_D50ToSRGB, PAL_D50ToSRGB_D50, PAL_D50ToWGamut, PALToAdobe, PALToAdobe_D50, PALToApple, PALToApple_D50, PALToBest, PALToBeta, PALToBruce, PALToBruce_D50, PALToCIE, PALToCIE_D50, PALToColorMatch, PALToDon, PALToECI, PALToEktaSpace, PALToNTSC, PALToNTSC_D50, PALToPAL_D50, PALToProPhoto, PALToSMPTE_C, PALToSMPTE_C_D50, PALToSRGB, PALToSRGB_D50, PALToWGamut, ProPhotoToAdobe, ProPhotoToAdobe_D50, ProPhotoToApple, ProPhotoToApple_D50, ProPhotoToBest, ProPhotoToBeta, ProPhotoToBruce, ProPhotoToBruce_D50, ProPhotoToCIE, ProPhotoToCIE_D50, ProPhotoToColorMatch, ProPhotoToDon, ProPhotoToECI, ProPhotoToEktaSpace, ProPhotoToNTSC, ProPhotoToNTSC_D50, ProPhotoToPAL, ProPhotoToPAL_D50, ProPhotoToSMPTE_C, ProPhotoToSMPTE_C_D50, ProPhotoToSRGB, ProPhotoToSRGB_D50, ProPhotoToWGamut, SMPTE_C_D50ToAdobe, SMPTE_C_D50ToAdobe_D50, SMPTE_C_D50ToApple, SMPTE_C_D50ToApple_D50, SMPTE_C_D50ToBest, SMPTE_C_D50ToBeta, SMPTE_C_D50ToBruce, SMPTE_C_D50ToBruce_D50, SMPTE_C_D50ToCIE, SMPTE_C_D50ToCIE_D50, SMPTE_C_D50ToColorMatch, SMPTE_C_D50ToDon, SMPTE_C_D50ToECI, SMPTE_C_D50ToEktaSpace, SMPTE_C_D50ToNTSC, SMPTE_C_D50ToNTSC_D50, SMPTE_C_D50ToPAL, SMPTE_C_D50ToPAL_D50, SMPTE_C_D50ToProPhoto, SMPTE_C_D50ToSMPTE_C, SMPTE_C_D50ToSRGB, SMPTE_C_D50ToSRGB_D50, SMPTE_C_D50ToWGamut, SMPTE_CToAdobe, SMPTE_CToAdobe_D50, SMPTE_CToApple, SMPTE_CToApple_D50, SMPTE_CToBest, SMPTE_CToBeta, SMPTE_CToBruce, SMPTE_CToBruce_D50, SMPTE_CToCIE, SMPTE_CToCIE_D50, SMPTE_CToColorMatch, SMPTE_CToDon, SMPTE_CToECI, SMPTE_CToEktaSpace, SMPTE_CToNTSC, SMPTE_CToNTSC_D50, SMPTE_CToPAL, SMPTE_CToPAL_D50, SMPTE_CToProPhoto, SMPTE_CToSMPTE_C_D50, SMPTE_CToSRGB, SMPTE_CToSRGB_D50, SMPTE_CToWGamut, SRGB_D50ToAdobe, SRGB_D50ToAdobe_D50, SRGB_D50ToApple, SRGB_D50ToApple_D50, SRGB_D50ToBest, SRGB_D50ToBeta, SRGB_D50ToBruce, SRGB_D50ToBruce_D50, SRGB_D50ToCIE, SRGB_D50ToCIE_D50, SRGB_D50ToColorMatch, SRGB_D50ToDon, SRGB_D50ToECI, SRGB_D50ToEktaSpace, SRGB_D50ToNTSC, SRGB_D50ToNTSC_D50, SRGB_D50ToPAL, SRGB_D50ToPAL_D50, SRGB_D50ToProPhoto, SRGB_D50ToSMPTE_C, SRGB_D50ToSMPTE_C_D50, SRGB_D50ToSRGB, SRGB_D50ToWGamut, SRGBToAdobe, SRGBToAdobe_D50, SRGBToApple, SRGBToApple_D50, SRGBToBest, SRGBToBeta, SRGBToBruce, SRGBToBruce_D50, SRGBToCIE, SRGBToCIE_D50, SRGBToColorMatch, SRGBToDon, SRGBToECI, SRGBToEktaSpace, SRGBToNTSC, SRGBToNTSC_D50, SRGBToPAL, SRGBToPAL_D50, SRGBToProPhoto, SRGBToSMPTE_C, SRGBToSMPTE_C_D50, SRGBToSRGB_D50, SRGBToWGamut, WGamutToAdobe, WGamutToAdobe_D50, WGamutToApple, WGamutToApple_D50, WGamutToBest, WGamutToBeta, WGamutToBruce, WGamutToBruce_D50, WGamutToCIE, WGamutToCIE_D50, WGamutToColorMatch, WGamutToDon, WGamutToECI, WGamutToEktaSpace, WGamutToNTSC, WGamutToNTSC_D50, WGamutToPAL, WGamutToPAL_D50, WGamutToProPhoto, WGamutToSMPTE_C, WGamutToSMPTE_C_D50, WGamutToSRGB, WGamutToSRGB_D50}

	f2 := []fn2{AdobeToAdobe_D50, AppleToAdobe_D50, Apple_D50ToAdobe_D50, BestToAdobe_D50, BetaToAdobe_D50, BruceToAdobe_D50, Bruce_D50ToAdobe_D50, CIEToAdobe_D50, CIE_D50ToAdobe_D50, ColorMatchToAdobe_D50, DonToAdobe_D50, ECIToAdobe_D50, EktaSpaceToAdobe_D50, NTSCToAdobe_D50, NTSC_D50ToAdobe_D50, PALToAdobe_D50, PAL_D50ToAdobe_D50, ProPhotoToAdobe_D50, SMPTE_CToAdobe_D50, SMPTE_C_D50ToAdobe_D50, SRGBToAdobe_D50, SRGB_D50ToAdobe_D50, WGamutToAdobe_D50, Adobe_D50ToAdobe, AppleToAdobe, Apple_D50ToAdobe, BestToAdobe, BetaToAdobe, BruceToAdobe, Bruce_D50ToAdobe, CIEToAdobe, CIE_D50ToAdobe, ColorMatchToAdobe, DonToAdobe, ECIToAdobe, EktaSpaceToAdobe, NTSCToAdobe, NTSC_D50ToAdobe, PALToAdobe, PAL_D50ToAdobe, ProPhotoToAdobe, SMPTE_CToAdobe, SMPTE_C_D50ToAdobe, SRGBToAdobe, SRGB_D50ToAdobe, WGamutToAdobe, AdobeToApple_D50, Adobe_D50ToApple_D50, AppleToApple_D50, BestToApple_D50, BetaToApple_D50, BruceToApple_D50, Bruce_D50ToApple_D50, CIEToApple_D50, CIE_D50ToApple_D50, ColorMatchToApple_D50, DonToApple_D50, ECIToApple_D50, EktaSpaceToApple_D50, NTSCToApple_D50, NTSC_D50ToApple_D50, PALToApple_D50, PAL_D50ToApple_D50, ProPhotoToApple_D50, SMPTE_CToApple_D50, SMPTE_C_D50ToApple_D50, SRGBToApple_D50, SRGB_D50ToApple_D50, WGamutToApple_D50, AdobeToApple, Adobe_D50ToApple, Apple_D50ToApple, BestToApple, BetaToApple, BruceToApple, Bruce_D50ToApple, CIEToApple, CIE_D50ToApple, ColorMatchToApple, DonToApple, ECIToApple, EktaSpaceToApple, NTSCToApple, NTSC_D50ToApple, PALToApple, PAL_D50ToApple, ProPhotoToApple, SMPTE_CToApple, SMPTE_C_D50ToApple, SRGBToApple, SRGB_D50ToApple, WGamutToApple, AdobeToBest, Adobe_D50ToBest, AppleToBest, Apple_D50ToBest, BetaToBest, BruceToBest, Bruce_D50ToBest, CIEToBest, CIE_D50ToBest, ColorMatchToBest, DonToBest, ECIToBest, EktaSpaceToBest, NTSCToBest, NTSC_D50ToBest, PALToBest, PAL_D50ToBest, ProPhotoToBest, SMPTE_CToBest, SMPTE_C_D50ToBest, SRGBToBest, SRGB_D50ToBest, WGamutToBest, AdobeToBeta, Adobe_D50ToBeta, AppleToBeta, Apple_D50ToBeta, BestToBeta, BruceToBeta, Bruce_D50ToBeta, CIEToBeta, CIE_D50ToBeta, ColorMatchToBeta, DonToBeta, ECIToBeta, EktaSpaceToBeta, NTSCToBeta, NTSC_D50ToBeta, PALToBeta, PAL_D50ToBeta, ProPhotoToBeta, SMPTE_CToBeta, SMPTE_C_D50ToBeta, SRGBToBeta, SRGB_D50ToBeta, WGamutToBeta, AdobeToBruce_D50, Adobe_D50ToBruce_D50, AppleToBruce_D50, Apple_D50ToBruce_D50, BestToBruce_D50, BetaToBruce_D50, BruceToBruce_D50, CIEToBruce_D50, CIE_D50ToBruce_D50, ColorMatchToBruce_D50, DonToBruce_D50, ECIToBruce_D50, EktaSpaceToBruce_D50, NTSCToBruce_D50, NTSC_D50ToBruce_D50, PALToBruce_D50, PAL_D50ToBruce_D50, ProPhotoToBruce_D50, SMPTE_CToBruce_D50, SMPTE_C_D50ToBruce_D50, SRGBToBruce_D50, SRGB_D50ToBruce_D50, WGamutToBruce_D50, AdobeToBruce, Adobe_D50ToBruce, AppleToBruce, Apple_D50ToBruce, BestToBruce, BetaToBruce, Bruce_D50ToBruce, CIEToBruce, CIE_D50ToBruce, ColorMatchToBruce, DonToBruce, ECIToBruce, EktaSpaceToBruce, NTSCToBruce, NTSC_D50ToBruce, PALToBruce, PAL_D50ToBruce, ProPhotoToBruce, SMPTE_CToBruce, SMPTE_C_D50ToBruce, SRGBToBruce, SRGB_D50ToBruce, WGamutToBruce, AdobeToCIE_D50, Adobe_D50ToCIE_D50, AppleToCIE_D50, Apple_D50ToCIE_D50, BestToCIE_D50, BetaToCIE_D50, BruceToCIE_D50, Bruce_D50ToCIE_D50, CIEToCIE_D50, ColorMatchToCIE_D50, DonToCIE_D50, ECIToCIE_D50, EktaSpaceToCIE_D50, NTSCToCIE_D50, NTSC_D50ToCIE_D50, PALToCIE_D50, PAL_D50ToCIE_D50, ProPhotoToCIE_D50, SMPTE_CToCIE_D50, SMPTE_C_D50ToCIE_D50, SRGBToCIE_D50, SRGB_D50ToCIE_D50, WGamutToCIE_D50, AdobeToCIE, Adobe_D50ToCIE, AppleToCIE, Apple_D50ToCIE, BestToCIE, BetaToCIE, BruceToCIE, Bruce_D50ToCIE, CIE_D50ToCIE, ColorMatchToCIE, DonToCIE, ECIToCIE, EktaSpaceToCIE, NTSCToCIE, NTSC_D50ToCIE, PALToCIE, PAL_D50ToCIE, ProPhotoToCIE, SMPTE_CToCIE, SMPTE_C_D50ToCIE, SRGBToCIE, SRGB_D50ToCIE, WGamutToCIE, AdobeToColorMatch, Adobe_D50ToColorMatch, AppleToColorMatch, Apple_D50ToColorMatch, BestToColorMatch, BetaToColorMatch, BruceToColorMatch, Bruce_D50ToColorMatch, CIEToColorMatch, CIE_D50ToColorMatch, DonToColorMatch, ECIToColorMatch, EktaSpaceToColorMatch, NTSCToColorMatch, NTSC_D50ToColorMatch, PALToColorMatch, PAL_D50ToColorMatch, ProPhotoToColorMatch, SMPTE_CToColorMatch, SMPTE_C_D50ToColorMatch, SRGBToColorMatch, SRGB_D50ToColorMatch, WGamutToColorMatch, AdobeToDon, Adobe_D50ToDon, AppleToDon, Apple_D50ToDon, BestToDon, BetaToDon, BruceToDon, Bruce_D50ToDon, CIEToDon, CIE_D50ToDon, ColorMatchToDon, ECIToDon, EktaSpaceToDon, NTSCToDon, NTSC_D50ToDon, PALToDon, PAL_D50ToDon, ProPhotoToDon, SMPTE_CToDon, SMPTE_C_D50ToDon, SRGBToDon, SRGB_D50ToDon, WGamutToDon, AdobeToECI, Adobe_D50ToECI, AppleToECI, Apple_D50ToECI, BestToECI, BetaToECI, BruceToECI, Bruce_D50ToECI, CIEToECI, CIE_D50ToECI, ColorMatchToECI, DonToECI, EktaSpaceToECI, NTSCToECI, NTSC_D50ToECI, PALToECI, PAL_D50ToECI, ProPhotoToECI, SMPTE_CToECI, SMPTE_C_D50ToECI, SRGBToECI, SRGB_D50ToECI, WGamutToECI, AdobeToEktaSpace, Adobe_D50ToEktaSpace, AppleToEktaSpace, Apple_D50ToEktaSpace, BestToEktaSpace, BetaToEktaSpace, BruceToEktaSpace, Bruce_D50ToEktaSpace, CIEToEktaSpace, CIE_D50ToEktaSpace, ColorMatchToEktaSpace, DonToEktaSpace, ECIToEktaSpace, NTSCToEktaSpace, NTSC_D50ToEktaSpace, PALToEktaSpace, PAL_D50ToEktaSpace, ProPhotoToEktaSpace, SMPTE_CToEktaSpace, SMPTE_C_D50ToEktaSpace, SRGBToEktaSpace, SRGB_D50ToEktaSpace, WGamutToEktaSpace, AdobeToNTSC_D50, Adobe_D50ToNTSC_D50, AppleToNTSC_D50, Apple_D50ToNTSC_D50, BestToNTSC_D50, BetaToNTSC_D50, BruceToNTSC_D50, Bruce_D50ToNTSC_D50, CIEToNTSC_D50, CIE_D50ToNTSC_D50, ColorMatchToNTSC_D50, DonToNTSC_D50, ECIToNTSC_D50, EktaSpaceToNTSC_D50, NTSCToNTSC_D50, PALToNTSC_D50, PAL_D50ToNTSC_D50, ProPhotoToNTSC_D50, SMPTE_CToNTSC_D50, SMPTE_C_D50ToNTSC_D50, SRGBToNTSC_D50, SRGB_D50ToNTSC_D50, WGamutToNTSC_D50, AdobeToNTSC, Adobe_D50ToNTSC, AppleToNTSC, Apple_D50ToNTSC, BestToNTSC, BetaToNTSC, BruceToNTSC, Bruce_D50ToNTSC, CIEToNTSC, CIE_D50ToNTSC, ColorMatchToNTSC, DonToNTSC, ECIToNTSC, EktaSpaceToNTSC, NTSC_D50ToNTSC, PALToNTSC, PAL_D50ToNTSC, ProPhotoToNTSC, SMPTE_CToNTSC, SMPTE_C_D50ToNTSC, SRGBToNTSC, SRGB_D50ToNTSC, WGamutToNTSC, AdobeToPAL_D50, Adobe_D50ToPAL_D50, AppleToPAL_D50, Apple_D50ToPAL_D50, BestToPAL_D50, BetaToPAL_D50, BruceToPAL_D50, Bruce_D50ToPAL_D50, CIEToPAL_D50, CIE_D50ToPAL_D50, ColorMatchToPAL_D50, DonToPAL_D50, ECIToPAL_D50, EktaSpaceToPAL_D50, NTSCToPAL_D50, NTSC_D50ToPAL_D50, PALToPAL_D50, ProPhotoToPAL_D50, SMPTE_CToPAL_D50, SMPTE_C_D50ToPAL_D50, SRGBToPAL_D50, SRGB_D50ToPAL_D50, WGamutToPAL_D50, AdobeToPAL, Adobe_D50ToPAL, AppleToPAL, Apple_D50ToPAL, BestToPAL, BetaToPAL, BruceToPAL, Bruce_D50ToPAL, CIEToPAL, CIE_D50ToPAL, ColorMatchToPAL, DonToPAL, ECIToPAL, EktaSpaceToPAL, NTSCToPAL, NTSC_D50ToPAL, PAL_D50ToPAL, ProPhotoToPAL, SMPTE_CToPAL, SMPTE_C_D50ToPAL, SRGBToPAL, SRGB_D50ToPAL, WGamutToPAL, AdobeToProPhoto, Adobe_D50ToProPhoto, AppleToProPhoto, Apple_D50ToProPhoto, BestToProPhoto, BetaToProPhoto, BruceToProPhoto, Bruce_D50ToProPhoto, CIEToProPhoto, CIE_D50ToProPhoto, ColorMatchToProPhoto, DonToProPhoto, ECIToProPhoto, EktaSpaceToProPhoto, NTSCToProPhoto, NTSC_D50ToProPhoto, PALToProPhoto, PAL_D50ToProPhoto, SMPTE_CToProPhoto, SMPTE_C_D50ToProPhoto, SRGBToProPhoto, SRGB_D50ToProPhoto, WGamutToProPhoto, AdobeToSMPTE_C_D50, Adobe_D50ToSMPTE_C_D50, AppleToSMPTE_C_D50, Apple_D50ToSMPTE_C_D50, BestToSMPTE_C_D50, BetaToSMPTE_C_D50, BruceToSMPTE_C_D50, Bruce_D50ToSMPTE_C_D50, CIEToSMPTE_C_D50, CIE_D50ToSMPTE_C_D50, ColorMatchToSMPTE_C_D50, DonToSMPTE_C_D50, ECIToSMPTE_C_D50, EktaSpaceToSMPTE_C_D50, NTSCToSMPTE_C_D50, NTSC_D50ToSMPTE_C_D50, PALToSMPTE_C_D50, PAL_D50ToSMPTE_C_D50, ProPhotoToSMPTE_C_D50, SMPTE_CToSMPTE_C_D50, SRGBToSMPTE_C_D50, SRGB_D50ToSMPTE_C_D50, WGamutToSMPTE_C_D50, AdobeToSMPTE_C, Adobe_D50ToSMPTE_C, AppleToSMPTE_C, Apple_D50ToSMPTE_C, BestToSMPTE_C, BetaToSMPTE_C, BruceToSMPTE_C, Bruce_D50ToSMPTE_C, CIEToSMPTE_C, CIE_D50ToSMPTE_C, ColorMatchToSMPTE_C, DonToSMPTE_C, ECIToSMPTE_C, EktaSpaceToSMPTE_C, NTSCToSMPTE_C, NTSC_D50ToSMPTE_C, PALToSMPTE_C, PAL_D50ToSMPTE_C, ProPhotoToSMPTE_C, SMPTE_C_D50ToSMPTE_C, SRGBToSMPTE_C, SRGB_D50ToSMPTE_C, WGamutToSMPTE_C, AdobeToSRGB_D50, Adobe_D50ToSRGB_D50, AppleToSRGB_D50, Apple_D50ToSRGB_D50, BestToSRGB_D50, BetaToSRGB_D50, BruceToSRGB_D50, Bruce_D50ToSRGB_D50, CIEToSRGB_D50, CIE_D50ToSRGB_D50, ColorMatchToSRGB_D50, DonToSRGB_D50, ECIToSRGB_D50, EktaSpaceToSRGB_D50, NTSCToSRGB_D50, NTSC_D50ToSRGB_D50, PALToSRGB_D50, PAL_D50ToSRGB_D50, ProPhotoToSRGB_D50, SMPTE_CToSRGB_D50, SMPTE_C_D50ToSRGB_D50, SRGBToSRGB_D50, WGamutToSRGB_D50, AdobeToSRGB, Adobe_D50ToSRGB, AppleToSRGB, Apple_D50ToSRGB, BestToSRGB, BetaToSRGB, BruceToSRGB, Bruce_D50ToSRGB, CIEToSRGB, CIE_D50ToSRGB, ColorMatchToSRGB, DonToSRGB, ECIToSRGB, EktaSpaceToSRGB, NTSCToSRGB, NTSC_D50ToSRGB, PALToSRGB, PAL_D50ToSRGB, ProPhotoToSRGB, SMPTE_CToSRGB, SMPTE_C_D50ToSRGB, SRGB_D50ToSRGB, WGamutToSRGB, AdobeToWGamut, Adobe_D50ToWGamut, AppleToWGamut, Apple_D50ToWGamut, BestToWGamut, BetaToWGamut, BruceToWGamut, Bruce_D50ToWGamut, CIEToWGamut, CIE_D50ToWGamut, ColorMatchToWGamut, DonToWGamut, ECIToWGamut, EktaSpaceToWGamut, NTSCToWGamut, NTSC_D50ToWGamut, PALToWGamut, PAL_D50ToWGamut, ProPhotoToWGamut, SMPTE_CToWGamut, SMPTE_C_D50ToWGamut, SRGBToWGamut, SRGB_D50ToWGamut}

tests := 0
from := 12000
to := 35000
step = 16384
	nFunc := len(f1)
	maxSqErr := 0
	for i = 0; i < nFunc; i++ {
		fmt.Println("Testing fn #", i)
		for j = from; j <= to; j += step {

			for k = from; k <= to; k += step {
				for l = from; l <= to; l += step {
if j > 65535 {
	j = 65535
}
if k > 65535 {
	k = 65535
}
if l > 65535 {
	l = 65535
}



r, g, b = uint16(j), uint16(k), uint16(l)
					x, y, z := f1[i](r, g, b)
//		fmt.Println("rgb: ", r,g,b)
					tests++
					r1, g1, b1 := f2[i](x, y, z)
					if !(check_diff(r, r1) && check_diff(g, g1) && check_diff(b, b1)) {
					//	fmt.Printf(" fn # %d: r, g, b = %d, %d, %d   r1, g1, b1 = %d, %d, %d\n", i, r, g, b, r1, g1, b1)
					//	t.Errorf(" fn # %d: r, g, b = %d, %d, %d   r1, g1, b1 = %d, %d, %d\n", i, r, g, b, r1, g1, b1)
						t.Fatalf(" fn # %d: r, g, b = %d, %d, %d   r1, g1, b1 = %d, %d, %d\n", i, r, g, b, r1, g1, b1)
					}
					dr := (r - r1) * (r - r1)
					dg := (g - g1) * (g - g1)
					db := (b - b1) * (b - b1)
					d := dr + dg + db
					if int(d) > maxSqErr {
						rw, gw, bw = r, g, b
						r1w, g1w, b1w = r1, g1, b1
						maxSqErr = int(d)
					}
				}
			}
		}
	}
	fmt.Println("maxErr = ", math.Pow(float64(maxSqErr), 0.5))
	fmt.Println("RGB 0 = ", rw, gw, bw)
	fmt.Println("RGB 1 = ", r1w, g1w, b1w)
	fmt.Println("Number of tests = ", tests)
}
